<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DLLPluginSystem Gallery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body class="bg-gray-900 text-white font-sans antialiased">

    <header class="py-10 bg-gray-800 shadow-2xl border-b border-gray-700 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto px-6">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-extrabold text-blue-400 tracking-tight">Plugin Gallery</h1>
                <p class="text-gray-400 mt-2">Central Repository for DLLPluginSystem Modules</p>
            </div>
            
            <div class="flex flex-col md:flex-row gap-4 justify-center items-center">
                <div class="relative w-full md:w-96">
                    <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-500"></i>
                    <input type="text" id="search-input" placeholder="Search by name or description..." 
                           class="w-full bg-gray-950 border border-gray-700 rounded-xl py-3 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-blue-500 transition shadow-inner">
                </div>
                <select id="filter-type" class="w-full md:w-auto bg-gray-950 border border-gray-700 rounded-xl py-3 px-6 focus:outline-none focus:ring-2 focus:ring-blue-500 transition cursor-pointer">
                    <option value="all">All Platforms</option>
                    <option value="DLL">Windows (.dll)</option>
                    <option value="Python">Python (.py)</option>
                    <option value="SO">Linux (.so)</option>
                </select>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-6">
        <div id="plugin-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="col-span-full py-20 text-center">
                <i class="fas fa-circle-notch animate-spin text-4xl text-blue-500"></i>
                <p class="mt-4 text-gray-500">Fetching latest modules...</p>
            </div>
        </div>
    </main>

    <script>
        let allPlugins = [];

        async function init() {
            try {
                const response = await fetch('catalog.json');
                const data = await response.json();
                allPlugins = data.plugins;
                renderPlugins(allPlugins);
                
                document.getElementById('search-input').addEventListener('input', handleFilter);
                document.getElementById('filter-type').addEventListener('change', handleFilter);
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('plugin-list').innerHTML = `
                    <div class="col-span-full bg-red-900/20 border border-red-900 p-6 rounded-xl text-center">
                        <i class="fas fa-exclamation-triangle text-red-500 text-2xl mb-2"></i>
                        <p class="text-red-400">Failed to load plugin catalog. Please check your JSON structure.</p>
                    </div>`;
            }
        }

        function handleFilter() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const typeFilter = document.getElementById('filter-type').value;

            const filtered = allPlugins.filter(p => {
                const matchesSearch = p.name.toLowerCase().includes(searchTerm) || p.description.toLowerCase().includes(searchTerm);
                const matchesType = typeFilter === 'all' || p.type === typeFilter;
                return matchesSearch && matchesType;
            });
            renderPlugins(filtered);
        }

        function renderPlugins(plugins) {
            const container = document.getElementById('plugin-list');
            container.innerHTML = '';

            if (plugins.length === 0) {
                container.innerHTML = `<p class="text-center col-span-full text-gray-500 py-20">No matching plugins found.</p>`;
                return;
            }

            plugins.forEach(plugin => {
                // Determine Icon and Style
                const typeMap = {
                    'Python': { icon: 'fab fa-python', color: 'text-blue-400', bg: 'bg-blue-900/30' },
                    'DLL': { icon: 'fas fa-window-maximize', color: 'text-gray-300', bg: 'bg-gray-700/50' },
                    'SO': { icon: 'fab fa-linux', color: 'text-orange-400', bg: 'bg-orange-950/30' }
                };
                const style = typeMap[plugin.type] || { icon: 'fas fa-puzzle-piece', color: 'text-gray-400', bg: 'bg-gray-800' };

                const versionOptions = plugin.releases.map((rel, i) => 
                    `<option value="${rel.url}">${rel.version}${i === 0 ? ' (Latest)' : ''}</option>`
                ).join('');

                container.innerHTML += `
                    <div class="bg-gray-800 flex flex-col rounded-2xl border border-gray-700 hover:border-blue-500/50 hover:shadow-2xl hover:shadow-blue-500/10 transition-all duration-300 overflow-hidden">
                        <div class="p-6 flex-grow">
                            <div class="flex justify-between items-start mb-4">
                                <h2 class="text-xl font-bold text-white group-hover:text-blue-300 transition-colors">${plugin.name}</h2>
                                <span class="${style.bg} ${style.color} text-[10px] px-2.5 py-1 rounded-full font-bold uppercase tracking-wider flex items-center">
                                    <i class="${style.icon} mr-1.5"></i>${plugin.type}
                                </span>
                            </div>
                            <p class="text-gray-400 text-sm leading-relaxed line-clamp-3">${plugin.description}</p>
                        </div>
                        
                        <div class="px-6 pb-6 mt-auto">
                            <div class="space-y-4">
                                <div class="bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 flex items-center justify-between">
                                    <span class="text-[10px] text-gray-500 font-bold uppercase">Release</span>
                                    <select id="select-${plugin.id}" class="bg-transparent text-sm text-blue-400 focus:outline-none font-medium cursor-pointer">
                                        ${versionOptions}
                                    </select>
                                </div>

                                <div class="flex items-center justify-between gap-4">
                                    <div class="flex items-center text-gray-500">
                                        <i class="fas fa-user-circle text-xs mr-2"></i>
                                        <span class="text-xs truncate max-w-[80px]">${plugin.author}</span>
                                    </div>
                                    <button onclick="download('${plugin.id}')" 
                                            class="flex-grow bg-blue-600 hover:bg-blue-500 text-white py-2.5 rounded-xl text-sm font-bold transition-all transform active:scale-95 flex justify-center items-center gap-2 shadow-lg shadow-blue-900/20">
                                        <i class="fas fa-download text-xs"></i> Get Plugin
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>`;
            });
        }

        function download(id) {
            const url = document.getElementById(`select-${id}`).value;
            if(url) window.location.href = url;
        }

        init();
    </script>
</body>
</html>